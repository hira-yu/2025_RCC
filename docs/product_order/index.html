<!DOCTYPE html>
<html>
<head>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>オンライン注文 - ももポート</title>
  <link rel="icon" href="../favicon.ico" type="image/x-icon">
  <link rel="stylesheet" href="../css/common_header.css?v0.2">
  <link rel="stylesheet" href="./css/style.css?v=0.5">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <div id="loading-overlay" class="loading-overlay" style="display: none;">
      <div class="loading-spinner"></div>
      <p>注文を送信中...</p>
    </div>

    <header class="page-header">
        <img src="../img/momoport_logo.png" alt="ももポートロゴ" class="header-logo">
        <div class="icon_box">
            <div class="order-history-icon" id="order-history-icon">
                <i class="fas fa-history"></i>
            </div>
            <div class="order-status-icon">
                <i class="fas fa-receipt"></i>
            </div>
            <div class="line-login-container">
                <a href="#" id="line-login-button" class="line-login-button">
                    <img src="../img/btn_base.png" alt="LINEでログイン">
                </a>
            </div>
        </div>
    </header>
  <div id="loading" style="text-align: center; font-size: 32px;">商品情報を読み込み中...</div>
  <div id="product-list">
    </div>

  <div id="order-confirm-modal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeOrderModal()">&times;</span>
        
        <div class="order-summary-content">
            <h2>ご注文内容の確認</h2>
            <div id="cart-items-detail">
                <!-- カートの商品がここに動的に挿入されます -->
                <p class="empty-cart-message">カートは空です。</p>
            </div>
            <p><strong>合計金額: <span id="total-price-detail">0</span>円</strong></p>
            
            <label for="customerName">お名前:</label>
            <input type="text" id="customerName" placeholder="お名前を入力" required>

            <label for="customerEmail">メールアドレス:</label>
            <input type="email" id="customerEmail" placeholder="メールアドレスを入力">

            <label for="customerPhone">電話番号:</label>
            <input type="tel" id="customerPhone" placeholder="電話番号を入力">

            <label for="notes">特記事項:</label>
            <textarea id="notes" placeholder="アレルギーなど特記事項があれば..."></textarea>

            <div id="dynamic-questions-container">
                <!-- 動的に生成される質問項目がここに挿入されます -->
            </div>

            <button id="submit-order" class="submit-button btn btn-primary" onclick="submitOrder()">注文確定</button>
            <p id="message" class="error"></p>
        </div>
    </div>
</div>

<div class="fixed-cart-container">
    <div class="mini-cart-bar">
        <div class="cart-info">
            <span id="item-count">商品 0 点</span><br>
            <span id="total-price-mini">¥ 0</span>
        </div>
        <button class="view-cart-button btn btn-primary" onclick="openOrderModal()">注文へ進む &gt;</button>
    </div>
</div>

<div id="product-modal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal()">&times;</span>
        <div id="modal-image-container">
            <img id="modal-image" src="" alt="商品画像">
        </div>
        <h2 id="modal-product-name"></h2>
        <p id="modal-product-price"></p>
        
        <div class="details">
            <p id="modal-ingredients"><strong>原材料:</strong> </p>
            <p id="modal-allergens"><strong>アレルギー:</strong> </p>
        </div>

        <div id="modal-options-container">
            <!-- オプション選択UIがここに動的に挿入されます -->
        </div>

        <div id="modal-order-controls">
            <label>数量:</label>
            <div class="quantity-control">
                <button class="qty-button btn btn-outline" onclick="changeQuantity(-1)">&minus;</button>
                <input type="number" id="modal-quantity" value="1" min="1">
                <button class="qty-button btn btn-outline" onclick="changeQuantity(1)">&plus;</button>
            </div>
            <button id="add-to-cart-button" class="btn btn-success" onclick="addToCartFromModal()">カートに追加</button>
        </div>
        
        <p id="modal-message" class="error"></p>
    </div>
</div>

<div id="result-modal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeResultModal()">&times;</span>
        <h2 id="result-modal-title"></h2>
        <p id="result-modal-message"></p>
        <button class="btn btn-primary" onclick="closeResultModal()">閉じる</button>
    </div>
</div>

<div id="order-status-modal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeOrderStatusModal()">&times;</span>
        <h2>注文ステータス確認</h2>
        <div class="input-group">
            <label for="customerOrderId">注文ID:</label>
            <input type="text" id="customerOrderId" placeholder="注文IDを入力してください">
            <button id="checkOrderStatusBtn" class="btn btn-primary">ステータスを確認</button>
        </div>
        <div id="customerOrderStatusResult" class="message"></div>
        <div id="customerOrderDetails"></div>
    </div>
</div>

<div id="order-history-modal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeOrderHistoryModal()">&times;</span>
        <h2>注文履歴</h2>
        <div id="order-history-list">
            <p class="empty-history-message">注文履歴がありません。</p>
        </div>
        <button class="btn btn-primary" onclick="closeOrderHistoryModal()">閉じる</button>
    </div>
</div>

    <script src="./js/script.js"></script><script src="./js/customer_order_status.js"></script>
    <script src="./js/line_login.js"></script>
</body>
</html>